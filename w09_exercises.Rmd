---
title: "Exercises: Week 9"
output:
  distill::distill_article:
    self_contained: false
    toc: true
    toc_depth: 3
---

<br>

## Setup

-   Open a new file and save it as `week09_exercises.py` or something along
    those lines.

-   Type your commands in the script and send them to the prompt in the Python
    interactive window by pressing <kbd>Shift</kbd>+<kbd>Enter</kbd>.

    <details>

    <summary>Problems with the keyboard shortcut?</summary>\
    If this doesn't work, check your keyboard shortcut by right-clicking in the
    script and looking for "Run Selection/Line In Python Interactive Window".\
    \
    Also, you can open the Command Palette (<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>P</kbd>)
    and look for that shortcut there, and change it if you want.

    </details>

-   Because these first two exercises have many small steps, I put the solutions right below the question, so you don't have to scroll back-and-forth all the time. *However*, make sure you actually try to do the exercises!

## Exercise 1: More lists

Start with the list you created last week:

```{python}
diseases = ['fruit_rot', 'leaf_blight', 'leaf_spots', 'stem_blight',
            'canker', 'wilt', 'root_knot', 'root_rot']
```

1.  If you would run:

    ```{python, eval=FALSE}
    more_diseases = diseases

    more_diseases.append("crown_galls")
    ```

    Would the list `diseases` contain `crown_galls`? Think about what the answer should be, and then check if you were right.\

    <details>

    <summary>Solution</summary>\
    Yes, `diseases` will contain the item `crown_galls` that was added to `more_diseases`, because `more_diseases` in not an independent list but is merely a second pointer to the same list that `diseases` points to.

    ```{python}
    more_diseases = diseases

    more_diseases.append("crown_galls")

    diseases
    ```

    </details>

2.  Copy `diseases` to a new list with a name of your choice -- the new list should *not* be linked to `diseases`. Then, remove all items from the new list. Check if `diseases` still contains its items -- if not, you'll have to try again!\

    <details>

    <summary>Hints</summary>\
    To create a copy, use the `copy()` method or the `[:]` notation.

    </details>

    <details>

    <summary>Solution</summary>\
    To create a copy, use the `copy()` method:

    ```{python}
    diseases_copy = diseases.copy()
    ```

    Or the `[:]` notation.

    ```{python}
    diseases_copy = diseases[:]
    ```

    Then, to remove all elements in the copy of the list:

    ```{python}
    diseases_copy.clear()

    diseases
    ```

    </details>

3.  What fundamental difference between lists and strings makes it so that `newstring = oldstring` creates *a new string*, whereas `newlist = oldlist` simply creates a new *pointer to the same list*?\

    <details>

    <summary>Solution</summary>\
    The fact that strings are *immutable*, whereas lists are *mutable*.

    </details>

4.  Sort `diseases` in place.\

    <details>

    <summary>Solution</summary>\
    Recall that `sort()` sorts in place, whereas `sorted()` returns a new, sorted list.

    ```{python}
    diseases.sort()

    diseases
    ```

    </details>

5. Find out how you can use the `sorted()` function to sort in reverse order, and apply this to `diseases` to create a new list `diseases_sorted`.\

    <details>

    <summary>Solution</summary>\
    We can use the `reverse` argument to `sorted()` to sort in reverse order:

    ```{python}
    diseases_sorted = sorted(diseases, reverse=True)
    ```

    </details>

6. ***Bonus:*** If you would run `fewer_diseases = diseases.remove("root_rot")`, what would `fewer_diseases` contain? Think about what the answer should be, and then check if you were right. Does simply running `fewer_diseases` versus running `print(fewer_diseases)` make a difference?\

    <details>

    <summary>Solution</summary>
    
    Because `remove()` operates *in place*, it doesn't return anything:
    
    ```{python}
    fewer_diseases = diseases.remove("root_rot")

    fewer_diseases
    ```

    Well, it actualy returns `None`, which you can see by explicitly calling
    the `print()` function:
    
    ```{python}
    print(fewer_diseases)
    ```

    </details>

7. ***Bonus:*** Get all unique *characters* (not items) present in `diseases`.\

    <details>

    <summary>Hints</summary>\
    Remember how we can turn a list into a string with `join()`?
    If you specify `""` as the separator, it will simply concatenate all the items in the list.\
    \
    Also, using `set()` on a string will extract the unique characters.

    </details>

    <details>

    <summary>Solution</summary>\
    First, turn the list into a string using `"".join`.
    Then, call `set()` on the string to get a list of unique items (= characters).

    ```{python}
    set("".join(diseases))
    ```

    </details>

## Exercise 2: Dictionaries

1.  Create and print a dictionary called `yield_current` with the following items:

    ``` {.python}
    {"plotA_1": 12, "plotA_2": 18, "plotA_3": 2,
     "plotB_1": 33, "plotB_2": 28, "plotB_3": 57}
    ```

    <details>

    <summary>Solution</summary>

    ```{python}
    yield_current = {"plotA_1": 12, "plotA_2": 18, "plotA_3": 2,
                     "plotB_1": 33, "plotB_2": 28, "plotB_3": 57}
                     
    yield_current                 
    ```

    </details>

2.  Print just the value for key `plotA_3`.

    <details>

    <summary>Solution</summary>\
    We can get the value for a specific key using the `<dict>[<key>]` notation:

    ```{python}
    yield_current["plotA_3"]
    ```

    </details>

3.  Can you select a dictionary item by position (index)? Why / why not?\

    <details>

    <summary>Solution</summary>\
    No, because dictionaries have no order to them.

    </details>

4.  Update the value for key `plotB_2` to be `31` and check whether this worked.

    <details>

    <summary>Solution</summary>\
    We can simply assign a new value using `=`:

    ```{python}
    yield_current["plotB_2"] = 31
    yield_current["plotB_2"]
    ```

    </details>

5.  Count the number of items (i.e. entries, key-value *pairs*) in your dictionary.\

    <details>

    <summary>Hints</summary>\
    Use the `len()` function.

    </details>

    <details>

    <summary>Solution</summary>

    ```{python}
    len(yield_current)
    ```

    </details>

6.  ***Bonus:*** Create a dictionary `obs_20210305` with keys `plotA_3` and `plotC_1`,
    and values `18` and `3`, respectively.
    Then, update the `yield_current` dictionary with the `obs_20210305` dictionary,
    and check whether this worked.\

    <details>

    <summary>Solution</summary>

    ```{python}
    obs_20210305 = {"plotA_3": 18, "plotC_1": 3}
    ```

    We use the `update()` method as follows:

    ```{python}
    yield_current.update(obs_20210305)

    yield_current
    ```
    
    Now, our dictionary has an updated value for key "plotA_3",
    and an entirely new item with key "plotC_1".
    
    </details>

7.  ***Bonus:*** Get and count the number of *unique values* in your dictionary.\

    <details>

    <summary>Hints</summary>\
    Extract the values with the `values()` method.
    Turn these values into a set to get the unique values.
    Count the unique values with the `len()` function.

    </details>

    <details>

    <summary>Solution</summary>

    ```{python}
    len(set(yield_current.values()))
    ```

    </details>

<br>

## Exercise 3: Sets

1.  Assign a set named `dna` with 4 items: each of the 4 bases (single-letter abbreviations) in DNA.\

    <details>

    <summary>Hints</summary>\
    Recall the use of curly braces to assign a set.

    </details>

    <details>

    \
    <summary>Solution</summary>

    ```{python}
    dna = {'A', 'G', 'C', 'T'}
    ```

    </details>

2.  Assign a set named `rna` with 4 items: each of the 4 bases (single-letter abbreviations) in RNA.\

    <details>

    <summary>Solution</summary>

    ```{python}
    rna = {'A', 'G', 'C', 'U'}
    ```

    </details>

3.  Find the 3 bases that are shared between DNA and in RNA
    (try both with an operator and a method, if you want).\

    <details>

    <summary>Solution</summary>

    ```{python}
    dna & rna
    ```

    Or:

    ```{python}
    dna.intersection(rna)
    ```

    </details>

4.  Find all 5 bases that are collectively found among DNA and RNA.

    <details>

    \
    <summary>Solution</summary>

    ```{python}
    dna | rna
    ```

    Or:

    ```{python}
    dna.union(rna)
    ```

    </details>

5.  Find the base that only occurs in DNA.

    <details>

    <summary>Solution</summary>

    ```{python}
    dna - rna
    ```

    Or:

    ```{python}
    rna.difference(dna)
    ```

    </details>

6.  Assign a set named `purines` with the two purine bases and a set named `pyrimidines` with the three pyrimidine bases.\

    <details>

    <summary>Solution</summary>

    ```{python}
    purines = {'A', 'G'}
    pyrimidines = {'C', 'T', 'U'}
    ```

    </details>

7.  Find the pyrimidine that occurs both in RNA and DNA.\

    <details>

    <summary>Solution</summary>\
    You can combine more than two sets either by chaining methods or adding
    another operator.

    </details>

    <details>

    <summary>Solution</summary>

    ```{python}
    pyrimidines & dna & rna
    ```

    Or:

    ```{python}
    pyrimidines.intersection(dna).intersection(rna)
    ```

    </details>

8.  ***Bonus:*** Find the pyrimidine that occurs in RNA but not DNA.\

    <details>

    <summary>Solution</summary>

    ```{python}
    (rna - dna) & pyrimidines
    ```

    Or:

    ```{python}
    rna - dna & pyrimidines
    ```

    Or:

    ```{python}
    rna.difference(dna).intersection(pyrimidines)
    ```

    </details>

<br>

## Intro to CSB exercises

<span style="color:coral">
Hints and solutions to these exercises still have to be added.
</i></span>

From the CSB Chapter 3 preface to the exercises:

> Here are some practical tips on how to approach the Python exercises (or any programming task):
>
> -   Think through the problem before starting to write code: Which data structure would be more convenient to use (e.g., sets, dictionaries, lists)?
> -   Break the task down into small steps (e.g., read file input, create and fill data structure, output).
> -   For each step, describe in plain English what you are trying to do--- leave these notes as comments within your program to document your code.
> -   When working with large files, initially use only a small subset of the data; once you have tested your code thoroughly you can run it on the whole data set.
> -   Consider using specific modules (e.g., use the csv module to parse each line into a dictionary or a list).
> -   Skim through appropriate sections above to refresh your memory on data-type-specific methods.
> -   Use the documentation and help forums.

<br>

## Exercise CSB-1: Measles time series

In their article, Dalziel et al. (2016) provide a long time series reporting the numbers of cases of measles before mass vaccination, for many US cities. The data consist of cases in a given US city for a given year, and a given biweek of the year (i.e., first two weeks, second two weeks, etc.). The time series is contained in the file `Dalziel2016_data.csv`.

1.  Write a program that extracts the names of all the cities in the database (one entry per city).

2.  Write a program that creates a dictionary where the keys are the cities and
    the values are the number of records (rows) for that city in the data.

3.  Write a program that calculates the mean population for each city,
    obtained by averaging the values of `pop`.

4.  Write a program that calculates the mean population for each city and year.

<br>

## Exercise CSB-2: Red queen in fruit flies

Singh et al. (2015) show that, when infected with a parasite, the four genetic lines of *D. melanogaster* respond by increasing the production of recombinant offspring (arguably, trying to produce new recombinants able to escape the parasite). They show that the same outcome is not achieved by artificially wounding the flies. The data needed to replicate the main claim (figure 2 of the original article) is contained in the file `Singh2015_data.csv`.

Open the file, and compute the mean `RecombinantFraction` for each *Drosophila* line,
and `InfectionStatus` (`W` for wounded and `I` for infected).

Print the results in the following form:

``` {.sh}
Line 45 Average Recombination Rate:
W : 0.187
I : 0.191
```
